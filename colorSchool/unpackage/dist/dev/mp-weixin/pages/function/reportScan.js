(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/function/reportScan"],{252:
/*!***********************************************************************!*\
  !*** E:/project/my/colorUi/colorSchool/pages/function/reportScan.vue ***!
  \***********************************************************************/
/*! no static exports found */function(e,t,o){"use strict";o.r(t);var n=o(/*! ./reportScan.vue?vue&type=template&id=17792e2e& */253),r=o(/*! ./reportScan.vue?vue&type=script&lang=js& */255);for(var a in r)"default"!==a&&function(e){o.d(t,e,(function(){return r[e]}))}(a);var i,s=o(/*! ../../../../../../tool/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js */14),c=Object(s["default"])(r["default"],n["render"],n["staticRenderFns"],!1,null,null,null,!1,n["components"],i);c.options.__file="project/my/colorUi/colorSchool/pages/function/reportScan.vue",t["default"]=c.exports},253:
/*!******************************************************************************************************!*\
  !*** E:/project/my/colorUi/colorSchool/pages/function/reportScan.vue?vue&type=template&id=17792e2e& ***!
  \******************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(e,t,o){"use strict";o.r(t);var n=o(/*! -!../../../../../../tool/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../tool/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!../../../../../../tool/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../tool/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../tool/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../../../../tool/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./reportScan.vue?vue&type=template&id=17792e2e& */254);o.d(t,"render",(function(){return n["render"]})),o.d(t,"staticRenderFns",(function(){return n["staticRenderFns"]})),o.d(t,"recyclableRender",(function(){return n["recyclableRender"]})),o.d(t,"components",(function(){return n["components"]}))},254:
/*!******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!E:/project/my/colorUi/colorSchool/pages/function/reportScan.vue?vue&type=template&id=17792e2e& ***!
  \******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(e,t,o){"use strict";var n;o.r(t),o.d(t,"render",(function(){return r})),o.d(t,"staticRenderFns",(function(){return i})),o.d(t,"recyclableRender",(function(){return a})),o.d(t,"components",(function(){return n}));var r=function(){var e=this,t=e.$createElement,o=(e._self._c,e.__map(e.xgData,(function(t,o){var n=t.Detail.every((function(e){return 1==e.isCheck})),r=t.Detail.every((function(e){return 1==e.isCheck})),a=t.Detail.every((function(e){return 1==e.isCheck}));return{$orig:e.__get_orig(t),g0:n,g1:r,g2:a}})));e.$mp.data=Object.assign({},{$root:{l0:o}})},a=!1,i=[];r._withStripped=!0},255:
/*!************************************************************************************************!*\
  !*** E:/project/my/colorUi/colorSchool/pages/function/reportScan.vue?vue&type=script&lang=js& ***!
  \************************************************************************************************/
/*! no static exports found */function(e,t,o){"use strict";o.r(t);var n=o(/*! -!../../../../../../tool/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib!../../../../../../tool/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!../../../../../../tool/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../tool/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../../../../tool/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./reportScan.vue?vue&type=script&lang=js& */256),r=o.n(n);for(var a in n)"default"!==a&&function(e){o.d(t,e,(function(){return n[e]}))}(a);t["default"]=r.a},256:
/*!*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!E:/project/my/colorUi/colorSchool/pages/function/reportScan.vue?vue&type=script&lang=js& ***!
  \*******************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(e,t,o){"use strict";(function(e){function o(e,t){return a(e)||r(e,t)||n()}function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function r(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var o=[],n=!0,r=!1,a=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done);n=!0)if(o.push(i.value),t&&o.length===t)break}catch(c){r=!0,a=c}finally{try{n||null==s["return"]||s["return"]()}finally{if(r)throw a}}return o}}function a(e){if(Array.isArray(e))return e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={name:"temHome",props:{msg:{type:String,default:""},type:{type:String,default:""},fromm:{type:String,default:""}},data:function(){return{qrCode:"",qrCodeType:"",xgData:[],current:-1,chooseId:"",choosePlace:"",imgrow:[],lon:"",lat:"",commitTime:0,uploadImgRow:[],laizi:"",isAllCheck:[],safeImgRow:[],imgList:[],showimgList:!0,safePosition:"",yhposition:"",switchB:!1}},methods:{ChooseImageSafe:function(){var t=this;e.chooseImage({count:4,sizeType:["compressed"],sourceType:["camera"],success:function(e){0!=t.imgList.length?t.imgList=t.imgList.concat(e.tempFilePaths):t.imgList=e.tempFilePaths}})},ViewImageSafe:function(t){e.previewImage({urls:this.imgList,current:t.currentTarget.dataset.url})},DelImgSafe:function(t){var o=this;e.showModal({title:"删除",content:"确定要删除这张照片吗？",cancelText:"再看看",confirmText:"再见",success:function(e){e.confirm&&o.imgList.splice(t.currentTarget.dataset.index,1)}})},ChooseImage:function(t){var o=this;e.chooseImage({count:1,sizeType:["compressed"],sourceType:["camera"],success:function(e){console.log(e),o.imgrow[t].url.push(e.tempFilePaths[0])}})},ViewImage:function(t){e.previewImage({urls:this.imgrow[t.currentTarget.dataset.index].url,current:t.currentTarget.dataset.url})},DelImg2:function(t){var o=this;console.log(t),e.showModal({title:"删除",content:"确定要删除这张图片吗？",cancelText:"取消",confirmText:"确定",success:function(e){e.confirm&&o.safeImgRow.url.splice(t.currentTarget.dataset.index,1)}})},showModel:function(t){e.showModal({title:"提示",content:t,showCancel:!1,success:function(e){e.confirm}})},SwitchB:function(e){this.switchB=e.detail.value,console.log(this.switchB)},SwitchA:function(e){console.log(e);var t=[],o=!0,n=!1,r=void 0;try{for(var a,i=this.xgData[Symbol.iterator]();!(o=(a=i.next()).done);o=!0){var s=a.value;if(s.Name==e.currentTarget.dataset.title){e.detail.value?s.yhms=s.yhms.replace(e.currentTarget.dataset.info.content+",",""):s.yhms=s.yhms+e.currentTarget.dataset.info.content+",";var c=!0,l=!1,u=void 0;try{for(var h,f=s.Detail[Symbol.iterator]();!(c=(h=f.next()).done);c=!0){var m=h.value;m.content==e.currentTarget.dataset.info.content&&(m.isCheck=e.detail.value)}}catch(D){l=!0,u=D}finally{try{c||null==f.return||f.return()}finally{if(l)throw u}}}var d=!0,g=!1,p=void 0;try{for(var y,v=s.Detail[Symbol.iterator]();!(d=(y=v.next()).done);d=!0){var w=y.value;t.push(w.isCheck)}}catch(D){g=!0,p=D}finally{try{d||null==v.return||v.return()}finally{if(g)throw p}}}}catch(D){n=!0,r=D}finally{try{o||null==i.return||i.return()}finally{if(n)throw r}}t.every((function(e){return 1==e}))?this.showimgList=!0:this.showimgList=!1},getData:function(){var t=this;e.request({url:t.$store.state.urlPrefix+"/School/Get_HD",data:{QRCode:t.qrCode,type:t.qrCodeType,RYXH:t.$store.state.userInfo.RYXH,isCheck:"false"}}).then((function(n){var r=o(n,2),a=(r[0],r[1]);if(0==a.data.code){t.xgData=a.data.data,t.choosePlace=t.xgData[0].placeNo;var i=!0,s=!1,c=void 0;try{for(var l,u=t.xgData[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var h=l.value;h.yhms="",h.yhbw="",t.imgrow.push({name:h.ID,url:[]}),";"==h.Detail[h.Detail.length-1]&&(h.Detail=h.Detail.substr(0,h.Detail.length-1));var f=h.Detail.split(";");h.Detail=[];var m=!0,d=!1,g=void 0;try{for(var p,y=f[Symbol.iterator]();!(m=(p=y.next()).done);m=!0){var v=p.value;h.Detail.push({isCheck:!0,content:v})}}catch(w){d=!0,g=w}finally{try{m||null==y.return||y.return()}finally{if(d)throw g}}}}catch(w){s=!0,c=w}finally{try{i||null==u.return||u.return()}finally{if(s)throw c}}console.log(t.xgData),console.log(t.imgrow)}else e.showToast({title:"扫描失败",duration:2e3,icon:"loading"})}))},nextStep:function(){e.showLoading({title:"提交中。。。",mask:!0});var t=[],o=[],n=[];console.log(this.imgrow);var r=!0,a=!1,i=void 0;try{for(var s,c=this.xgData[Symbol.iterator]();!(r=(s=c.next()).done);r=!0){var l=s.value;l.yhms.length>0&&n.push({HDID:l.ID,CZWT:l.yhms,place:l.yhbw,position:this.yhposition});var u=!0,h=!1,f=void 0;try{for(var m,d=l.Detail[Symbol.iterator]();!(u=(m=d.next()).done);u=!0){var g=m.value;t.push(g.isCheck)}}catch(S){h=!0,f=S}finally{try{u||null==d.return||d.return()}finally{if(h)throw f}}}}catch(S){a=!0,i=S}finally{try{r||null==c.return||c.return()}finally{if(a)throw i}}if(console.log(n),t.every((function(e){return 1==e})))if(0==this.imgList.length)e.hideLoading(),this.showModel("请选择照片！");else{var p=this.imgList.length;this.uploadSafeImg(p)}else{for(var y=0;y<this.xgData.length;y++){if(!this.xgData[y].Detail.every((function(e){return 1==e.isCheck}))&&0==this.imgrow[y].url.length)return e.hideLoading(),void this.showModel("请完善隐患照片！");if(!this.xgData[y].Detail.every((function(e){return 1==e.isCheck}))&&0==this.xgData[y].yhbw.length)return e.hideLoading(),void this.showModel("请完善隐患部位！");this.xgData[y].Detail.every((function(e){return 1==e.isCheck}))||o.push(y)}p=0;for(var v=0;v<o.length;v++){var w=this.imgrow[o[v]].url.length,D=!0,T=!1,x=void 0;try{for(var C,b=this.imgrow[o[v]].url[Symbol.iterator]();!(D=(C=b.next()).done);D=!0){var L=C.value;this.uploadImgRow.push({id:this.imgrow[o[v]].name,url:L})}}catch(S){T=!0,x=S}finally{try{D||null==b.return||b.return()}finally{if(T)throw x}}p+=w}p>0&&(e.showLoading({title:"提交中。。。",mask:!0}),this.uploadDangerImg(p,n))}},uploadDangerImg:function(t,o){var n=this,r=n.$store.state.urlPrefix+"/Process/Everyone_safe_images2";e.uploadFile({url:r,filePath:n.uploadImgRow[n.commitTime].url,name:"image",formData:{RYXH:n.$store.state.userInfo.RYXH,HDID:n.uploadImgRow[n.commitTime].id},success:function(r){n.commitTime=n.commitTime+1,"ok"==r.data?n.commitTime<t?n.uploadDangerImg(t,o):(n.switchB?n.sceneReport(o):n.HYdangerCommit(o),n.commitTime=0):(e.hideLoading(),e.showModal({title:"提示",content:"上报失败！",showCancel:!1,success:function(t){t.confirm&&e.reLaunch({url:"/pages/basic/home/home"})}}))}})},uploadSafeImg:function(t){var o=this,n=o.$store.state.urlPrefix+"/Process/Everyone_safe_images2";e.uploadFile({url:n,filePath:o.imgList[o.commitTime],name:"image",formData:{RYXH:o.$store.state.userInfo.RYXH,HDID:o.choosePlace},success:function(n){o.commitTime=o.commitTime+1,"ok"==n.data?o.commitTime<t?o.uploadSafeImg(t):(o.HYsafeCommit(),o.commitTime=0):(e.hideLoading(),e.showModal({title:"提示",content:"上报失败！",showCancel:!1,success:function(t){t.confirm&&e.reLaunch({url:"/pages/basic/home/home"})}}))}})},HYdangerCommit:function(t){var n=this,r=JSON.stringify(t);e.request({url:n.$store.state.urlPrefix+"/school/ScanQRCode_report",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{RYXH:n.$store.state.userInfo.RYXH,hdDetail:r,lat:n.lat,lon:n.lon,type:n.qrCodeType}}).then((function(t){var n=o(t,2),r=(n[0],n[1]);e.hideLoading(),0==r.data.code?e.showModal({title:"提示",content:"提交成功！",showCancel:!1,confirmText:"确定",success:function(t){t.confirm&&e.reLaunch({url:"/pages/basic/home/home"})}}):1==r.data.code?e.showModal({title:"提示",content:r.data.msg,showCancel:!1,confirmText:"确定",success:function(t){t.confirm&&e.reLaunch({url:"/pages/basic/home/home"})}}):e.showModal({title:"提示",content:"上传失败",showCancel:!1,confirmText:"确定",success:function(t){t.confirm&&e.reLaunch({url:"/pages/basic/home/home"})}})}))},HYsafeCommit:function(){var t=this;e.request({url:t.$store.state.urlPrefix+"/school/ScanQRCode_report_safe",data:{RYXH:t.$store.state.userInfo.RYXH,placeNo:t.choosePlace,position:t.yhposition,type:t.qrCodeType,place:""}}).then((function(t){var n=o(t,2),r=(n[0],n[1]);e.hideLoading(),0==r.data.code?e.showModal({title:"提示",content:"提交成功！",showCancel:!1,confirmText:"确定",success:function(t){t.confirm&&e.reLaunch({url:"/pages/basic/home/home"})}}):1==r.data.code?e.showModal({title:"提示",content:r.data.msg,showCancel:!1,confirmText:"确定",success:function(t){e.reLaunch({url:"/pages/basic/home/home"})}}):e.showModal({title:"提示",content:"上传失败",showCancel:!1,confirmText:"确定",success:function(t){e.reLaunch({url:"/pages/basic/home/home"})}})}))},getPlace:function(t,n){var r=this;e.request({url:r.$store.state.urlPrefix+"/School/Get_PlaceWay",data:{QRCode:this.qrCode,type:this.qrCodeType}}).then((function(e){var t=o(e,2),n=(t[0],t[1]);console.log(n),0==n.data.code&&(r.safePosition=n.data.data)}))},getLocation:function(){var t=this;e.getLocation({type:"gcj02",success:function(e){t.lon=e.longitude,t.lat=e.latitude}})},sceneReport:function(t){console.log("postData");var n=this,r=JSON.stringify(t);e.request({url:n.$store.state.urlPrefix+"/School/ScanQRCode_report_slef",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{type:n.qrCodeType,RYXH:n.$store.state.userInfo.RYXH,placeNo:n.choosePlace,hdDetail:r,lat:n.lat,lon:n.lon}}).then((function(t){var n=o(t,2),r=(n[0],n[1]);e.hideLoading(),0==r.data.code?e.showModal({title:"提示",content:"提交成功！",showCancel:!1,confirmText:"确定",success:function(t){t.confirm&&e.reLaunch({url:"/pages/basic/home/home"})}}):1==r.data.code?e.showModal({title:"提示",content:r.data.msg,showCancel:!1,confirmText:"确定",success:function(t){t.confirm&&e.reLaunch({url:"/pages/basic/home/home"})}}):e.showModal({title:"提示",content:"上传失败",showCancel:!1,confirmText:"确定",success:function(t){t.confirm&&e.reLaunch({url:"/pages/basic/home/home"})}})}))}},mounted:function(){this.qrCode=this._props.msg,this.qrCodeType=this._props.type,this.$emit("hideLoading",.1),this.getData(),this.getLocation(),this.getPlace()}};t.default=i}).call(this,o(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1)["default"])}}]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/function/reportScan.js.map
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'pages/function/reportScan-create-component',
    {
        'pages/function/reportScan-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('1')['createComponent'](__webpack_require__(252))
        })
    },
    [['pages/function/reportScan-create-component']]
]);
