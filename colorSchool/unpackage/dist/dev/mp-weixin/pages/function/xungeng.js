(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/function/xungeng"],{247:
/*!********************************************************************!*\
  !*** E:/project/my/colorUi/colorSchool/pages/function/xungeng.vue ***!
  \********************************************************************/
/*! no static exports found */function(e,t,o){"use strict";o.r(t);var n=o(/*! ./xungeng.vue?vue&type=template&id=b1ffdbca& */248),a=o(/*! ./xungeng.vue?vue&type=script&lang=js& */250);for(var r in a)"default"!==r&&function(e){o.d(t,e,(function(){return a[e]}))}(r);var i,s=o(/*! ../../../../../../tool/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js */14),c=Object(s["default"])(a["default"],n["render"],n["staticRenderFns"],!1,null,null,null,!1,n["components"],i);c.options.__file="project/my/colorUi/colorSchool/pages/function/xungeng.vue",t["default"]=c.exports},248:
/*!***************************************************************************************************!*\
  !*** E:/project/my/colorUi/colorSchool/pages/function/xungeng.vue?vue&type=template&id=b1ffdbca& ***!
  \***************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(e,t,o){"use strict";o.r(t);var n=o(/*! -!../../../../../../tool/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../../../tool/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!../../../../../../tool/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../tool/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../../../tool/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../../../../tool/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./xungeng.vue?vue&type=template&id=b1ffdbca& */249);o.d(t,"render",(function(){return n["render"]})),o.d(t,"staticRenderFns",(function(){return n["staticRenderFns"]})),o.d(t,"recyclableRender",(function(){return n["recyclableRender"]})),o.d(t,"components",(function(){return n["components"]}))},249:
/*!***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--16-0!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!E:/project/my/colorUi/colorSchool/pages/function/xungeng.vue?vue&type=template&id=b1ffdbca& ***!
  \***************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! exports provided: render, staticRenderFns, recyclableRender, components */function(e,t,o){"use strict";var n;o.r(t),o.d(t,"render",(function(){return a})),o.d(t,"staticRenderFns",(function(){return i})),o.d(t,"recyclableRender",(function(){return r})),o.d(t,"components",(function(){return n}));var a=function(){var e=this,t=e.$createElement,o=(e._self._c,e.__map(e.xgData,(function(t,o){var n=t.Detail.every((function(e){return 1==e.isCheck})),a=t.Detail.every((function(e){return 1==e.isCheck})),r=t.Detail.every((function(e){return 1==e.isCheck}));return{$orig:e.__get_orig(t),g0:n,g1:a,g2:r}})));e.$mp.data=Object.assign({},{$root:{l0:o}})},r=!1,i=[];a._withStripped=!0},250:
/*!*********************************************************************************************!*\
  !*** E:/project/my/colorUi/colorSchool/pages/function/xungeng.vue?vue&type=script&lang=js& ***!
  \*********************************************************************************************/
/*! no static exports found */function(e,t,o){"use strict";o.r(t);var n=o(/*! -!../../../../../../tool/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib!../../../../../../tool/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!../../../../../../tool/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../tool/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!../../../../../../tool/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./xungeng.vue?vue&type=script&lang=js& */251),a=o.n(n);for(var r in n)"default"!==r&&function(e){o.d(t,e,(function(){return n[e]}))}(r);t["default"]=a.a},251:
/*!****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/babel-loader/lib!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader??ref--12-1!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!./node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib??vue-loader-options!./node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!E:/project/my/colorUi/colorSchool/pages/function/xungeng.vue?vue&type=script&lang=js& ***!
  \****************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************************/
/*! no static exports found */function(e,t,o){"use strict";(function(e){function o(e,t){return r(e)||a(e,t)||n()}function n(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}function a(e,t){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e)){var o=[],n=!0,a=!1,r=void 0;try{for(var i,s=e[Symbol.iterator]();!(n=(i=s.next()).done);n=!0)if(o.push(i.value),t&&o.length===t)break}catch(c){a=!0,r=c}finally{try{n||null==s["return"]||s["return"]()}finally{if(a)throw r}}return o}}function r(e){if(Array.isArray(e))return e}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i={name:"temHome",props:{msg:{type:String,default:""},type:{type:String,default:""}},data:function(){return{qrCode:"",qrCodeType:"",xgData:[],current:-1,chooseId:"",choosePlace:"",imgrow:[],lon:"",lat:"",commitTime:0,uploadImgRow:[],laizi:"",isAllCheck:[],safeImgRow:[],imgList:[],showimgList:!0,safePosition:"",disabled:!1,switchB:!1}},methods:{sceneRepot:function(t){var n=this,a=JSON.stringify(t);e.request({url:n.$store.state.urlPrefix+"/School/Everyone_reports_self_Check",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{type:n.qrCodeType,RYXH:n.$store.state.userInfo.RYXH,placeNo:n.choosePlace,hdDetail:a,lat:n.lat,lon:n.lon}}).then((function(t){var a=o(t,2),r=(a[0],a[1]);e.hideLoading(),n.disabled=!1,0==r.data.code?e.showModal({title:"提示",content:"提交成功！",showCancel:!1,confirmText:"确定",success:function(t){t.confirm&&e.reLaunch({url:"/pages/basic/home/home"})}}):1==r.data.code?e.showModal({title:"提示",content:r.data.msg,showCancel:!1,confirmText:"确定",success:function(t){t.confirm&&e.reLaunch({url:"/pages/basic/home/home"})}}):e.showModal({title:"提示",content:"上传失败",showCancel:!1,confirmText:"确定",success:function(t){t.confirm&&e.reLaunch({url:"/pages/basic/home/home"})}})}))},SwitchB:function(e){this.switchB=e.detail.value,console.log(this.switchB)},ChooseImageSafe:function(){var t=this;e.chooseImage({count:4,sizeType:["compressed"],sourceType:["camera"],success:function(e){0!=t.imgList.length?t.imgList=t.imgList.concat(e.tempFilePaths):t.imgList=e.tempFilePaths}})},ViewImageSafe:function(t){e.previewImage({urls:this.imgList,current:t.currentTarget.dataset.url})},DelImgSafe:function(t){var o=this;e.showModal({title:"删除",content:"确定要删除这张照片吗？",cancelText:"再看看",confirmText:"再见",success:function(e){e.confirm&&o.imgList.splice(t.currentTarget.dataset.index,1)}})},ChooseImage:function(t){var o=this;e.chooseImage({count:1,sizeType:["compressed"],sourceType:["camera"],success:function(e){console.log(e),o.imgrow[t].url.push(e.tempFilePaths[0])}})},ViewImage:function(t){e.previewImage({urls:this.imgrow[t.currentTarget.dataset.index].url,current:t.currentTarget.dataset.url})},DelImg2:function(t){var o=this;console.log(t),e.showModal({title:"删除",content:"确定要删除这张图片吗？",cancelText:"取消",confirmText:"确定",success:function(e){e.confirm&&o.safeImgRow.url.splice(t.currentTarget.dataset.index,1)}})},showModel:function(t){e.showModal({title:"提示",content:t,showCancel:!1,success:function(e){e.confirm}})},SwitchA:function(e){console.log(e);var t=[],o=!0,n=!1,a=void 0;try{for(var r,i=this.xgData[Symbol.iterator]();!(o=(r=i.next()).done);o=!0){var s=r.value;if(s.Name==e.currentTarget.dataset.title){e.detail.value?s.yhms=s.yhms.replace(e.currentTarget.dataset.info.content+",",""):s.yhms=s.yhms+e.currentTarget.dataset.info.content+",";var c=!0,l=!1,u=void 0;try{for(var h,d=s.Detail[Symbol.iterator]();!(c=(h=d.next()).done);c=!0){var f=h.value;f.content==e.currentTarget.dataset.info.content&&(f.isCheck=e.detail.value)}}catch(x){l=!0,u=x}finally{try{c||null==d.return||d.return()}finally{if(l)throw u}}}var m=!0,g=!1,p=void 0;try{for(var y,v=s.Detail[Symbol.iterator]();!(m=(y=v.next()).done);m=!0){var w=y.value;t.push(w.isCheck)}}catch(x){g=!0,p=x}finally{try{m||null==v.return||v.return()}finally{if(g)throw p}}}}catch(x){n=!0,a=x}finally{try{o||null==i.return||i.return()}finally{if(n)throw a}}t.every((function(e){return 1==e}))?this.showimgList=!0:this.showimgList=!1},getData:function(){var t,n=this;t="隐患上报"==n.fromm?"false":"true",e.request({url:n.$store.state.urlPrefix+"/School/Get_HD",data:{QRCode:n.qrCode,type:n.qrCodeType,RYXH:n.$store.state.userInfo.RYXH,isCheck:t}}).then((function(t){var a=o(t,2),r=(a[0],a[1]);if(0==r.data.code){n.xgData=r.data.data,n.choosePlace=n.xgData[0].placeNo;var i=!0,s=!1,c=void 0;try{for(var l,u=n.xgData[Symbol.iterator]();!(i=(l=u.next()).done);i=!0){var h=l.value;h.yhms="",h.yhbw="",n.imgrow.push({name:h.ID,url:[]}),";"==h.Detail[h.Detail.length-1]&&(h.Detail=h.Detail.substr(0,h.Detail.length-1));var d=h.Detail.split(";");h.Detail=[];var f=!0,m=!1,g=void 0;try{for(var p,y=d[Symbol.iterator]();!(f=(p=y.next()).done);f=!0){var v=p.value;h.Detail.push({isCheck:!0,content:v})}}catch(w){m=!0,g=w}finally{try{f||null==y.return||y.return()}finally{if(m)throw g}}}}catch(w){s=!0,c=w}finally{try{i||null==u.return||u.return()}finally{if(s)throw c}}console.log(n.xgData),console.log(n.imgrow)}else 1==r.data.code&&e.showModal({title:"提示",content:r.data.msg,showCancel:!1,confirmText:"确定",success:function(t){t.confirm&&e.reLaunch({url:"/pages/basic/home/home"})}})}))},nextStep:function(){this.disabled=!0,e.showLoading({title:"提交中。。。",mask:!0});var t=[],o=[],n=[];console.log(this.xgData);var a=!0,r=!1,i=void 0;try{for(var s,c=this.xgData[Symbol.iterator]();!(a=(s=c.next()).done);a=!0){var l=s.value;l.yhms.length>0&&n.push({HDID:l.ID,CZWT:l.yhms,place:l.yhbw,position:""});var u=!0,h=!1,d=void 0;try{for(var f,m=l.Detail[Symbol.iterator]();!(u=(f=m.next()).done);u=!0){var g=f.value;t.push(g.isCheck)}}catch(S){h=!0,d=S}finally{try{u||null==m.return||m.return()}finally{if(h)throw d}}}}catch(S){r=!0,i=S}finally{try{a||null==c.return||c.return()}finally{if(r)throw i}}if(console.log(n),t.every((function(e){return 1==e}))){var p=this.imgList.length;0==p?(e.hideLoading(),this.disabled=!1,this.showModel("请拍摄照片")):this.uploadSafeImg(p)}else{for(var y=0;y<this.xgData.length;y++){if(!this.xgData[y].Detail.every((function(e){return 1==e.isCheck}))&&0==this.imgrow[y].url.length)return e.hideLoading(),this.disabled=!1,void this.showModel("请完善隐患照片！");if(!this.xgData[y].Detail.every((function(e){return 1==e.isCheck}))&&0==this.xgData[y].yhbw.length)return e.hideLoading(),this.disabled=!1,void this.showModel("请完善隐患部位！");this.xgData[y].Detail.every((function(e){return 1==e.isCheck}))||o.push(y)}p=0;for(var v=0;v<o.length;v++){var w=this.imgrow[o[v]].url.length,x=!0,C=!1,D=void 0;try{for(var b,T=this.imgrow[o[v]].url[Symbol.iterator]();!(x=(b=T.next()).done);x=!0){var L=b.value;this.uploadImgRow.push({id:this.imgrow[o[v]].name,url:L})}}catch(S){C=!0,D=S}finally{try{x||null==T.return||T.return()}finally{if(C)throw D}}p+=w}p>0&&(e.showLoading({title:"提交中。。。",mask:!0}),this.uploadDangerImg(p,n))}},getLocation:function(){var t=this;e.getLocation({type:"gcj02",success:function(e){t.lon=e.longitude,t.lat=e.latitude}})},uploadDangerImg:function(t,o){var n=this,a=n.$store.state.urlPrefix+"/Process/Everyone_safe_images2";e.uploadFile({url:a,filePath:n.uploadImgRow[n.commitTime].url,name:"image",formData:{RYXH:n.$store.state.userInfo.RYXH,HDID:n.uploadImgRow[n.commitTime].id},success:function(a){n.commitTime=n.commitTime+1,"ok"==a.data?n.commitTime<t?n.uploadDangerImg(t,o):(n.switchB?n.sceneRepot(o):n.dangerCommit(o),n.commitTime=0):(e.hideLoading(),n.disabled=!1,e.showModal({title:"提示",content:"上报失败！",showCancel:!1,success:function(t){t.confirm&&e.reLaunch({url:"/pages/basic/home/home"})}}))}})},uploadSafeImg:function(t){var o=this,n=o.$store.state.urlPrefix+"/Process/Everyone_safe_images2";e.uploadFile({url:n,filePath:o.imgList[o.commitTime],name:"image",formData:{RYXH:o.$store.state.userInfo.RYXH,HDID:o.choosePlace},success:function(n){o.commitTime=o.commitTime+1,"ok"==n.data?o.commitTime<t?o.uploadSafeImg(t):(o.safeCommit(),o.commitTime=0):(e.hideLoading(),o.disabled=!1,e.showModal({title:"提示",content:"上报失败！",showCancel:!1,success:function(t){t.confirm&&e.reLaunch({url:"/pages/basic/home/home"})}}))}})},safeCommit:function(){var t=this;e.request({url:t.$store.state.urlPrefix+"/School/ScanQRCode_Check_Safe",data:{type:t.qrCodeType,RYXH:t.$store.state.userInfo.RYXH,placeNo:t.choosePlace}}).then((function(n){var a=o(n,2),r=(a[0],a[1]);e.hideLoading(),t.disabled=!1,0==r.data.code?e.showModal({title:"提示",content:"提交成功！",showCancel:!1,confirmText:"确定",success:function(t){t.confirm&&e.reLaunch({url:"/pages/basic/home/home"})}}):1==r.data.code?e.showModal({title:"提示",content:r.data.msg,showCancel:!1,confirmText:"确定",success:function(t){t.confirm&&e.reLaunch({url:"/pages/basic/home/home"})}}):e.showModal({title:"提示",content:"上传失败",showCancel:!1,confirmText:"确定",success:function(t){t.confirm&&e.reLaunch({url:"/pages/basic/home/home"})}})}))},dangerCommit:function(t){var n=this,a=JSON.stringify(t);console.log(a),e.request({url:n.$store.state.urlPrefix+"/School/ScanQRCode_Check_Danger",method:"POST",header:{"content-type":"application/x-www-form-urlencoded"},data:{type:n.qrCodeType,RYXH:n.$store.state.userInfo.RYXH,placeNo:n.choosePlace,hdDetail:a,lat:n.lat,lon:n.lon}}).then((function(t){var a=o(t,2),r=(a[0],a[1]);e.hideLoading(),n.disabled=!1,0==r.data.code?e.showModal({title:"提示",content:"提交成功！",showCancel:!1,confirmText:"确定",success:function(t){t.confirm&&e.reLaunch({url:"/pages/basic/home/home"})}}):1==r.data.code?e.showModal({title:"提示",content:r.data.msg,showCancel:!1,confirmText:"确定",success:function(t){t.confirm&&e.reLaunch({url:"/pages/basic/home/home"})}}):e.showModal({title:"提示",content:"上传失败",showCancel:!1,confirmText:"确定",success:function(t){t.confirm&&e.reLaunch({url:"/pages/basic/home/home"})}})}))},getPlace:function(t,n){var a=this;e.request({url:a.$store.state.urlPrefix+"/School/Get_PlaceWay",data:{QRCode:this.qrCode,type:this.qrCodeType}}).then((function(e){var t=o(e,2),n=(t[0],t[1]);console.log(n),0==n.data.code&&(a.safePosition=n.data.data)}))}},mounted:function(){this.qrCode=this._props.msg,this.qrCodeType=this._props.type,this.$emit("hideLoading",.1),console.log(this.qrCode,this.qrCodeType),this.getData(),this.getLocation(),this.getPlace()}};t.default=i}).call(this,o(/*! ./node_modules/@dcloudio/uni-mp-weixin/dist/index.js */1)["default"])}}]);
//# sourceMappingURL=../../../.sourcemap/mp-weixin/pages/function/xungeng.js.map
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'pages/function/xungeng-create-component',
    {
        'pages/function/xungeng-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('1')['createComponent'](__webpack_require__(247))
        })
    },
    [['pages/function/xungeng-create-component']]
]);
